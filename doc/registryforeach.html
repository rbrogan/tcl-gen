<!DOCTYPE html>
<html>
<head>
<title>RegistryForEach</title>
<link rel="stylesheet" type="text/css" href="doc.css">
<body>
<div class="section_header">
NAME
</div>
<div class="section_content">
RegistryForEach  &mdash;  Iterate over names, data, and types in a way like dict for.
</div>
<div class="section_header">
SYNOPSIS
</div>
<div class="section_content">
<b>RegistryForEach</b> <i>VarNameList</i> <i>RegistryKeyPath</i> <i>Body</i> <i>?SubkeyHandlingOption?</i>
</div>
<div class="section_header">
DESCRIPTION
</div>
<div class="section_content">
<div class='subsection_header'>Return Value</div>
<div class='subsection_content'>
None.</div><div class='subsection_header'>Arguments</div><div class='subsection_content'><table class='argument_table'><tr class='table_row_b'><td class='argument_left'><i>VarNameList</i></td><td class='argument_right'>Names of variables to hold the key / value name, data, and type.</td></tr><tr class='table_row_a'><td class='argument_left'><i>RegistryKeyPath</i></td><td class='argument_right'>Path of registry key.</td></tr><tr class='table_row_b'><td class='argument_left'><i>Body</i></td><td class='argument_right'>Code to execute on each iteration.</td></tr><tr class='table_row_a'><td class='argument_left'><i>SubkeyHandlingOption</i></td><td class='argument_right'>Tell whether to handle subkeys and how to handle them (see below).</td></tr></table></div><div class = 'subsection_header'>Error Conditions</div>
<div class= 'subsection_content'>
<table>
<tr>
<th>Condition</th><th>Error Code</th><th>Error Message</th></tr>
<tr><td>Contents of variable are invalid.</td>
<td class="error_code">-11</td>
<td>Variable $VarName has invalid value $Value.</td>
</tr>
<tr><td>Registry key or value not found.</td>
<td class="error_code">-16</td>
<td>Registry key/value $Element not found.</td>
</tr>
</table>
</div><div class = 'subsection_header'>More Info</div><div class= 'subsection_content'>This command is intended to be like <code>dict for</code> but there are differences. (1) Since the registry values have a type, we have a third variable to hold that, in addition to Key and Value. See example for detail. (2) Rather than automatically recurse into subtrees, you have several options for how to handle them.<p>To handle keys, we have the following three options:<br>
1. <code>--values-only</code> : Default option. Do not process subkeys. Iterate over values only.<br>
2. <code>--subkeys-empty</code> : Iterate over subkeys, set the value type to "key", but leave contents empty. User will take action.<br>
3. <code>--subkeys-dicts</code> : Iterate over subkeys, set value type to "key", and set value data to be the dict returned from calling <code>RegistryTree2Dict</code>, using the subkey as argument.<br></p><p>If you do set options to iterate over subkeys, note that this command is currently set up to first iterate over all values and second iterate over subkeys. There is, as yet, no option to mix keys and values in alphabetical order.</p><p></p></div>
</div>
<div class="section_header">
EXAMPLES
</div>
<div class="section_content">
<div class="code_sample"><pre>% set MyRegKeyPath {HKEY_CURRENT_USER\Software\My\RegistryForeachTests}<br>HKEY_CURRENT_USER\Software\My\RegistryForeachTests<br>% <b>RegistryForEach {ValueName ValueData ValueType} $MyRegKeyPath { puts "$ValueName ($ValueData) $ValueType" } </b><br></pre></div>
<div class="section_header" >
SEE ALSO
</div>
<div class="section_content" >
<a href = 'registrywitheach.html'>RegistryWithEach</a>
</div>
<div class="section_header" >
KEYWORDS
</div>
<div class="section_content" >
<a href="keyword-index.html#C_control">control</a>, <a href="keyword-index.html#C_loop">loop</a>, <a href="keyword-index.html#C_registry">registry</a>
</div>
</body>
</html>
